<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GreshamTech – Carve‑out Discovery Intake Form</title>
  <style>
    :root{
      --ink:#14213d; --brand:#fca311; --muted:#e5e7eb; --bg:#ffffff; --ok:#16a34a; --warn:#dc2626;
    }
    html,body{font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"; background:var(--bg); color:#111827; margin:0}
    header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--muted);z-index:10}
    header .bar{display:flex;align-items:center;gap:1rem;max-width:1100px;margin:auto;padding:1rem}
    .logo{width:36px;height:36px;border-radius:8px;background:linear-gradient(135deg,var(--ink),#1f3a8a);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
    h1{font-size:1.25rem;margin:0}
    main{max-width:1100px;margin:1rem auto 4rem auto;padding:0 1rem}
    .card{border:1px solid var(--muted);border-radius:12px;padding:1rem;margin:1rem 0;background:#fff}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:1rem}
    .col-12{grid-column:span 12}
    .col-6{grid-column:span 6}
    .col-4{grid-column:span 4}
    .col-3{grid-column:span 3}
    @media (max-width:800px){.col-6,.col-4,.col-3{grid-column:span 12}}
    label{display:block;font-size:.9rem;color:#374151;margin:.25rem 0}
    input,select,textarea{width:100%;box-sizing:border-box;padding:.6rem .7rem;border:1px solid #cbd5e1;border-radius:8px;background:#fff}
    textarea{min-height:80px}
    .hint{font-size:.8rem;color:#6b7280}
    .section-title{display:flex;align-items:center;justify-content:space-between}
    .section-title h2{margin:.2rem 0;font-size:1.05rem}
    .btn{display:inline-flex;align-items:center;gap:.4rem;border:1px solid #cbd5e1;border-radius:10px;padding:.55rem .8rem;background:#fff;cursor:pointer}
    .btn.brand{background:var(--brand);border-color:var(--brand);color:#111827;font-weight:600}
    .btn.ghost{background:#fff}
    .btn.danger{border-color:var(--warn);color:var(--warn)}
    .pill{display:inline-block;padding:.2rem .5rem;border-radius:999px;background:#eef2ff;color:#3730a3;font-size:.75rem}
    .tool{border:1px dashed #cbd5e1;border-radius:10px;padding:1rem;margin:.75rem 0}
    .toolbar{display:flex;gap:.5rem;flex-wrap:wrap}
    .req:after{content:" *";color:var(--warn)}
    .footer-actions{position:fixed;right:1rem;bottom:1rem;display:flex;gap:.6rem;flex-wrap:wrap}
    .success{color:var(--ok)}
    .error{color:var(--warn)}
    .small{font-size:.85rem;color:#4b5563}
    .hidden{display:none}
    .domain-badge{font-weight:600}
    .inline{display:inline}
    .spacer{height:72px}
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="logo">GT</div>
      <div>
        <h1>Carve‑out Discovery – SME Intake</h1>
        <div class="small">Please complete one submission per domain (EUC/Infra, IAM/Infosec, Contact Centre/Service Desk, DevOps/Engineering, CRM, PSA).</div>
      </div>
    </div>
  </header>
  <main>
    <form id="intakeForm" class="card" onsubmit="return false">
      <section>
        <div class="section-title">
          <h2>1) Submission & Context</h2>
          <span class="pill">Required</span>
        </div>
        <div class="grid">
          <div class="col-6">
            <label class="req">Your name</label>
            <input id="smeName" required placeholder="Jane Doe" />
          </div>
          <div class="col-6">
            <label class="req">Email</label>
            <input id="smeEmail" type="email" required placeholder="jane.doe@example.com" />
          </div>
          <div class="col-6">
            <label class="req">Business unit / acquired entity</label>
            <input id="businessUnit" required placeholder="e.g., Xceptor North America" />
          </div>
          <div class="col-6">
            <label>Region(s)</label>
            <input id="regions" placeholder="EMEA, AMER, APAC" />
          </div>
          <div class="col-6">
            <label class="req">Domain</label>
            <select id="domain" required>
              <option value="">Select…</option>
              <option>EUC / Infrastructure & Cloud</option>
              <option>IAM / Information Security</option>
              <option>Contact Centre / Service Desk</option>
              <option>DevOps / Engineering</option>
              <option>CRM</option>
              <option>PSA</option>
            </select>
          </div>
          <div class="col-6">
            <label>Submission date</label>
            <input id="submittedOn" type="date" />
          </div>
          <div class="col-12">
            <label>Executive summary (1–3 sentences)</label>
            <textarea id="execSummary" placeholder="Key responsibilities of this domain today and headline risks/dependencies."/></textarea>
          </div>
        </div>
      </section>

      <section>
        <div class="section-title">
          <h2>2) Services, Tools & Software in Current State</h2>
          <div class="toolbar">
            <button class="btn brand" type="button" onclick="addTool()">＋ Add service / tool</button>
          </div>
        </div>
        <div id="tools"></div>
        <div class="hint">Add one entry per distinct service or tool provided by S&P (or tightly coupled third‑party) that your domain depends on.</div>
      </section>

      <section class="card">
        <div class="section-title">
          <h2>3) Cross‑cutting Details</h2>
        </div>
        <div class="grid">
          <div class="col-6">
            <label>Primary integrations (systems & data flows)</label>
            <textarea id="primaryIntegrations" placeholder="e.g., Okta → Azure AD; Jira → GitHub; Salesforce ↔ NetSuite; voice platform ↔ ticketing"/></textarea>
          </div>
          <div class="col-6">
            <label>Support model (queues, hours, ownership, runbooks)</label>
            <textarea id="supportModel" placeholder="e.g., S&P L1 via ServiceNow 24x5, L2/L3 on‑call, runbooks in Confluence"/></textarea>
          </div>
          <div class="col-6">
            <label>Compliance & data residency constraints</label>
            <textarea id="compliance" placeholder="e.g., ISO 27001, SOC 2, GDPR, PCI; data stored in EU regions"/></textarea>
          </div>
          <div class="col-6">
            <label>Known risks / tech debt</label>
            <textarea id="risks" placeholder="e.g., unsupported version, expiring certs, single admin, bespoke scripts"/></textarea>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="section-title">
          <h2>4) Migration Considerations</h2>
        </div>
        <div class="grid">
          <div class="col-6">
            <label>Continuity requirements (RTO/RPO, blackout windows)</label>
            <textarea id="continuity" placeholder="e.g., RTO 4h, RPO 15m; avoid last business day of month"/></textarea>
          </div>
          <div class="col-6">
            <label>Target‑state preferences / constraints</label>
            <textarea id="targetState" placeholder="e.g., move CI/CD to GitHub Actions; consolidate to Azure; retain SIP trunks"/></textarea>
          </div>
          <div class="col-6">
            <label>Decommission steps & data retention</label>
            <textarea id="decom" placeholder="e.g., archive S3 buckets 7y; export tickets; freeze users 30d, then disable"/></textarea>
          </div>
          <div class="col-6">
            <label>Key timelines / contract end dates</label>
            <textarea id="timelines" placeholder="e.g., vendor renewal 2026‑05‑31; TLS cert 2026‑03‑15; DC lease 2026‑08‑01"/></textarea>
          </div>
        </div>
      </section>
    </form>

    <div class="spacer"></div>
  </main>

  <div class="footer-actions card">
    <button class="btn brand" onclick="downloadJSON()">Download JSON</button>
    <button class="btn ghost" onclick="copyJSON()">Copy JSON</button>
    <button class="btn ghost" onclick="window.print()">Print / Save PDF</button>
    <span id="status" class="small"></span>
  </div>

<script>
  const toolsEl = document.getElementById('tools');
  let toolCount = 0;

  function addTool(prefill={}){
    const id = `tool_${++toolCount}`;
    const div = document.createElement('div');
    div.className = 'tool';
    div.dataset.id = id;
    div.innerHTML = `
      <div class=\"section-title\">
        <div>
          <span class=\"pill domain-badge\">Service / Tool #${toolCount}</span>
        </div>
        <div class=\"toolbar\">
          <button class=\"btn\" type=\"button\" onclick=\"moveTool(this, -1)\">↑ Move up</button>
          <button class=\"btn\" type=\"button\" onclick=\"moveTool(this, 1)\">↓ Move down</button>
          <button class=\"btn danger\" type=\"button\" onclick=\"this.closest('.tool').remove()\">Remove</button>
        </div>
      </div>
      <div class=\"grid\">
        <div class=\"col-6\">
          <label class=\"req\">Name</label>
          <input data-k=\"name\" required placeholder=\"e.g., Okta, ServiceNow, Azure AD\" value=\"${prefill.name||''}\"/>
        </div>
        <div class=\"col-6\">
          <label>Vendor</label>
          <input data-k=\"vendor\" placeholder=\"e.g., Microsoft, Atlassian\" value=\"${prefill.vendor||''}\"/>
        </div>
        <div class=\"col-12\">
          <label class=\"req\">Purpose / what it does</label>
          <textarea data-k=\"purpose\" required placeholder=\"Short description of the service role\">${prefill.purpose||''}</textarea>
        </div>
        <div class=\"col-4\">
          <label>Criticality</label>
          <select data-k=\"criticality\">
            <option></option>
            <option>High</option>
            <option>Medium</option>
            <option>Low</option>
          </select>
        </div>
        <div class=\"col-4\">
          <label>User base / seats</label>
          <input data-k=\"users\" placeholder=\"e.g., 120 named; 45 concurrent\" value=\"${prefill.users||''}\"/>
        </div>
        <div class=\"col-4\">
          <label>Environments</label>
          <input data-k=\"environments\" placeholder=\"e.g., Prod/Non‑prod; regions\" value=\"${prefill.environments||''}\"/>
        </div>
        <div class=\"col-6\">
          <label>Authentication / IAM model</label>
          <input data-k=\"iam\" placeholder=\"e.g., SSO via AAD; local accounts; SCIM\" value=\"${prefill.iam||''}\"/>
        </div>
        <div class=\"col-6\">
          <label>Access controls / roles</label>
          <input data-k=\"roles\" placeholder=\"e.g., admin, power user, read‑only\" value=\"${prefill.roles||''}\"/>
        </div>
        <div class=\"col-12\">
          <label>Integrations & dependencies</label>
          <textarea data-k=\"integrations\" placeholder=\"Up/downstream systems, data interfaces\">${prefill.integrations||''}</textarea>
        </div>
        <div class=\"col-6\">
          <label>Data stored / residency</label>
          <input data-k=\"data\" placeholder=\"e.g., PII in EU (Ireland); logs US\" value=\"${prefill.data||''}\"/>
        </div>
        <div class=\"col-6\">
          <label>SLA / SLO</label>
          <input data-k=\"sla\" placeholder=\"e.g., 99.9% uptime; P1 1h\" value=\"${prefill.sla||''}\"/>
        </div>
        <div class=\"col-6\">
          <label>Backups & DR</label>
          <input data-k=\"dr\" placeholder=\"e.g., daily snapshots; cross‑region\" value=\"${prefill.dr||''}\"/>
        </div>
        <div class=\"col-6\">
          <label>Runbooks / documentation links</label>
          <input data-k=\"docs\" placeholder=\"URLs to Confluence/SharePoint\" value=\"${prefill.docs||''}\"/>
        </div>
        <div class=\"col-6\">
          <label>Licensing model</label>
          <input data-k=\"licensing\" placeholder=\"e.g., per‑user E3; per‑core\" value=\"${prefill.licensing||''}\"/>
        </div>
        <div class=\"col-3\">
          <label>Approx. monthly cost (currency)</label>
          <input data-k=\"monthlyCost\" placeholder=\"e.g., 1,200 GBP\" value=\"${prefill.monthlyCost||''}\"/>
        </div>
        <div class=\"col-3\">
          <label>Contract / renewal date</label>
          <input data-k=\"renewal\" type=\"date\" value=\"${prefill.renewal||''}\"/>
        </div>
        <div class=\"col-12\">
          <label>Security / compliance notes</label>
          <textarea data-k=\"security\" placeholder=\"e.g., MFA required, audit logs retained 1y\">${prefill.security||''}</textarea>
        </div>
        <div class=\"col-12\">
          <label>Migration considerations</label>
          <textarea data-k=\"migration\" placeholder=\"e.g., data export path, cutover approach, blockers\">${prefill.migration||''}</textarea>
        </div>
      </div>`;
    toolsEl.appendChild(div);
  }

  function moveTool(btn, dir){
    const tool = btn.closest('.tool');
    const parent = tool.parentElement;
    const sib = dir < 0 ? tool.previousElementSibling : tool.nextElementSibling;
    if(!sib) return;
    if(dir < 0){ parent.insertBefore(tool, sib); }
    else{ parent.insertBefore(sib, tool); }
  }

  function collect(){
    const form = document.getElementById('intakeForm');
    // basic required checks
    if(!form.checkValidity()){
      document.getElementById('status').textContent = 'Please complete all required fields (marked *).';
      document.getElementById('status').className = 'small error';
      return null;
    }
    const payload = {
      meta: {
        toolVersion: '1.0.0',
        generatedAt: new Date().toISOString()
      },
      submission: {
        smeName: document.getElementById('smeName').value.trim(),
        smeEmail: document.getElementById('smeEmail').value.trim(),
        businessUnit: document.getElementById('businessUnit').value.trim(),
        regions: document.getElementById('regions').value.trim(),
        domain: document.getElementById('domain').value,
        submittedOn: document.getElementById('submittedOn').value,
        execSummary: document.getElementById('execSummary').value.trim()
      },
      crossCutting: {
        primaryIntegrations: document.getElementById('primaryIntegrations').value.trim(),
        supportModel: document.getElementById('supportModel').value.trim(),
        compliance: document.getElementById('compliance').value.trim(),
        risks: document.getElementById('risks').value.trim()
      },
      services: []
    };

    toolsEl.querySelectorAll('.tool').forEach((el) => {
      const svc = {};
      el.querySelectorAll('[data-k]').forEach((inp) => {
        const k = inp.dataset.k;
        svc[k] = (inp.tagName === 'TEXTAREA' || inp.tagName === 'INPUT') ? inp.value.trim() : inp.value;
      });
      payload.services.push(svc);
    });

    return payload;
  }

  async function copyJSON(){
    const payload = collect();
    if(!payload) return;
    const txt = JSON.stringify(payload, null, 2);
    await navigator.clipboard.writeText(txt);
    const s = document.getElementById('status');
    s.textContent = 'Copied JSON to clipboard.';
    s.className = 'small success';
  }

  function downloadJSON(){
    const payload = collect();
    if(!payload) return;
    const blob = new Blob([JSON.stringify(payload,null,2)], {type:'application/json'});
    const a = document.createElement('a');
    const bu = (payload.submission.businessUnit||'entity').replace(/[^a-z0-9]+/gi,'-').toLowerCase();
    const dom = (payload.submission.domain||'domain').replace(/[^a-z0-9]+/gi,'-').toLowerCase();
    a.download = `greshamtech-discovery-${bu}-${dom}.json`;
    a.href = URL.createObjectURL(blob);
    document.body.appendChild(a);
    a.click();
    a.remove();
    const s = document.getElementById('status');
    s.textContent = 'Download started.';
    s.className = 'small success';
  }

  // Add an initial empty tool block for convenience
  addTool();
</script>
</body>
</html>